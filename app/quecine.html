<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no" />
	<title>Que Cine</title>
	<link rel="stylesheet" href="style/headers.css">
	<link rel="stylesheet" href="style_unstable/drawer.css">

	<!-- Transitions -->
    <link rel="stylesheet" href="transitions.css">

	<!-- Util CSS: some extra tricks -->
	<link rel="stylesheet" href="util.css">
	<link rel="stylesheet" href="fonts.css">

	<!-- Additional markup to make Building Blocks kind of cross browser -->
  	<link rel="stylesheet" href="cross_browser.css">
  	<style type="text/css">
  	  div[role="main"]{
  	  	float: left;
		width: 100%;
		padding: 0px 15px;
		height: 2000px!important;
  	  }
  	</style>
  </head>
  <body>
	 	<section id="index" data-position="current">    
			<!--MENU-->
			<section data-type="sidebar">
			  <header>
			    <menu type="toolbar"></menu>
			    <h1>Menu</h1>
			  </header>
			  <nav>
			    <ul>
			      <li><a href="#content">Peliculas</a></li>
			      <li><a href="#content">Cines</a></li>
			    </ul>
			  </nav>
			</section>

			<!--PRINCIPAL-->
			<section id="drawer" role="region">
			  <header>
			  	<a href="#content"><span class="icon icon-menu">hide sidebar</span></a>
		    	<a href="#drawer"><span class="icon icon-menu">show sidebar</span></a>
		    	<h1>Que Cine</h1>
			  </header>
			  <div role="main" id="principal">
			  	<p>Hola</p>

			  </div>
			</section>
		</section>
		<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript">
		
			$(document).ready(function(){
				
				var URL = "http://192.168.1.33:8001/"

				var CINE = new Object();
				CINE.CINEPLANET = 01;
				
				var urlCines = URL + "cines/?format=json"
				var urlPeliculas = URL + "peliculas/?format=json"
				var urlHorarios = URL + "get-horarios/?format=json"
				
				var sdcard = navigator.getDeviceStorage('apps');

				
				function createCORSRequest(method, url) {
				  var xhr = new XMLHttpRequest();
				  if ("withCredentials" in xhr) {
				    // XHR for Chrome/Firefox/Opera/Safari.
				    xhr.open(method, url, true);
				  } else if (typeof XDomainRequest != "undefined") {
				    // XDomainRequest for IE.
				    xhr = new XDomainRequest();
				    xhr.open(method, url);
				  } else {
				    // CORS not supported.
				    xhr = null;
				  }
				  return xhr;
				}

				// Make the actual CORS request.
				function makeCorsRequest(url, fileName) {
				  // All HTML5 Rocks properties support CORS.
				  var xhr = createCORSRequest('GET', url);
				  if (!xhr) {
				    alert('CORS not supported');
				    return;
				  }

				  // Response handlers.
				  xhr.onload = function() {
				    var text = xhr.responseText;
				    var file   = new Blob([text], {type: "text/plain"});
				    var request = sdcard.addNamed(file, fileName);

				    request.onsuccess = function () {
						  var name = this.result;
						  alert('File "' + name + '" successfully wrote on the sdcard storage area');
						}
				    //escribir archivo en sdcard
				  };

				  xhr.onerror = function(e) {
				    alert(e);
				  };

				  xhr.send();
				}

				var cines = makeCorsRequest(urlCines, 'cines.json');
				var peliculas = makeCorsRequest(urlPeliculas, 'peliculas.json');
				var horarios = makeCorsRequest(urlHorarios, 'horarios.json');
				
			});
		</script>
  </body>
</html>
	